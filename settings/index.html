<!DOCTYPE html>

<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>tinyfy.io/fun</title>
        
        <link rel="icon" href="../parts/images/icon.ico">
        <link rel="stylesheet" href="../style.css">
    </head>

    <body>
        <div class="navbar">

            <!--Burger Menu-->
            <div class="menu-icon" id="menuIcon" title="Menu">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <div class="page-title">
                <h2>Settings</h2>
            </div>
        </div>
        
        <!--Horizontal Navbar Line-->
        <hr class="navbar-bar">

        <!--Drop Down Menu-->
        <div class="dropdown-menu" id="dropdownMenu">
            <a href="..">Home</a>
            <a href="../fun-projects">Fun Projects</a>
            <a href="../about-me">About Me</a>
            <a href="https://mussawir.netlify.app/settings">Settings</a>
            <a href="../feedback">Feedback</a>
        </div>

        <!--Main Body Content of Page-->
        <div class="content-settings">

            <!--Ping Checker-->
            <div class="ping-checker">

                <!--HTML Frame-->
                <div class="ping-container">
                    <div class="signal-bars">
                        <div class="bar" id="bar1"></div>
                        <div class="bar" id="bar2"></div>
                        <div class="bar" id="bar3"></div>
                        <div class="bar" id="bar4"></div>
                    </div>

                    <div>
                        <div class="ping-text" id="ping-value">--ms</div>
                        <div class="ping-status" id="ping-status">Checking...</div>
                    </div>
                <div>
                
                <!--JS for Ping Checker-->
                <script>
                    async function checkPing() {
                        const start = performance.now();
                        try {
                            // Add random param to prevent caching
                            await fetch('https://www.gov.sg/', {
                                cache: 'no-cache',
                                method: 'GET'
                            });
                            const ping = Math.round(performance.now() - start);
                            return ping;
                        } catch (error) {
                            return -1;
                        }
                    }

                    function updateSignalBars(ping) {
                        const bars = ['bar1', 'bar2', 'bar3', 'bar4'];
                        const statusElement = document.getElementById('ping-status');

                        // Reset all bars
                        bars.forEach(id => {
                            document.getElementById(id).className = 'bar';
                        })

                        if (ping === -1) {
                            statusElement.textContent = 'Connection failed';
                            return;
                        }

                        let strength, status, colorClass;

                        if (ping<50) {
                            strength = 4;
                            status = 'Excellent';
                            colorClass = 'active';
                        } else if (ping<100) {
                            strength = 3;
                            status = 'Good';
                            colorClass = 'active';
                        } else if (ping<200) {
                            strength = 2;
                            status = 'Fair';
                            colorClass = 'medium';
                        } else {
                            strength = 1;
                            status = 'Poor';
                            colorClass = 'slow';
                        }

                        statusElement.textContent = status;

                        // Light up bars based on strength
                        for (let i = 0; i < strength; i++) {
                            document.getElementById(bars[i]).className = `bar ${colorClass}`;
                        }
                    }

                    async function updatePing() {
                        const ping = await checkPing();
                        const pingElement = document.getElementById('ping-value');

                        if (ping === -1) {
                            pingElement.textContent =  'Error';
                        } else {
                            pingElement.textContent = ping + 'ms';
                        }

                        updateSignalBars(ping);
                    }

                    // Start pinging
                    updatePing();

                    // Update Every Single Second
                    setInterval(updatePing, 1000);
                </script>
            </div>

        </div>

        <!--Footer-->
        <div class="footer" style="margin: 30.2rem 0 0 0">

            <p>This Page Updated: Sep 3, 2025</p>
            <p>Â© 2025 MussTheGoose @ mussawir.netlify.app</p>

        </div>

        <script src="../script.js"></script>
    </body>

</html>
